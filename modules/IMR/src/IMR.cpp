// currently IMR is implemented in the .hpp file, but it can be later refactored into this .cpp file for better organization.